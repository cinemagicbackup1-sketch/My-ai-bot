
<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Smart AI Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: radial-gradient(circle, #1e293b 0%, #0f172a 100%); color: white; height: 100vh; display: flex; flex-direction: column; }
        .chat-container { flex: 1; overflow-y: auto; padding: 20px; scroll-behavior: smooth; }
        .user-bubble { background: #3b82f6; border-radius: 20px 20px 0 20px; align-self: flex-end; padding: 12px; max-width: 80%; margin-bottom: 10px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .ai-bubble { background: #334155; border-radius: 20px 20px 20px 0; align-self: flex-start; padding: 12px; max-width: 80%; margin-bottom: 10px; border: 1px solid #475569; }
    </style>
</head>
<body>
    <header class="p-4 bg-slate-900 text-center border-b border-slate-700">
        <h1 class="text-xl font-bold text-blue-400">‚ö° My Smart AI Assistant</h1>
        <p class="text-[10px] text-gray-400">Personalized for MGVCL Smart Meter Updates</p>
    </header>

    <div id="chat-box" class="chat-container flex flex-col">
        <div class="ai-bubble">‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§®‡§Ø‡§æ ‡§î‡§∞ ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü AI ‡§π‡•Ç‡§Å‡•§ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º ‡§≠‡•Ä ‡§∏‡•Å‡§® ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å ‡§î‡§∞ ‡§¨‡•ã‡§≤‡§ï‡§∞ ‡§ú‡§µ‡§æ‡§¨ ‡§≠‡•Ä ‡§¶‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å‡•§</div>
    </div>

    <div class="p-4 bg-slate-900 border-t border-slate-700">
        <div class="flex gap-2">
            <input id="input" type="text" placeholder="‡§™‡•Ç‡§õ‡•á‡§Ç ‡§Ø‡§æ MGVCL ‡§Æ‡•Ä‡§ü‡§∞ ‡§Ö‡§™‡§°‡•á‡§ü ‡§¶‡•á‡§Ç..." class="flex-1 p-3 rounded-full bg-slate-800 border border-slate-700 outline-none focus:border-blue-500 transition-all">
            <button onclick="send()" class="bg-blue-600 p-3 rounded-full hover:bg-blue-500 transition-all">üöÄ</button>
        </div>
        <div class="flex justify-between items-center mt-3">
            <button onclick="toggleSettings()" class="text-xs text-gray-500 underline">‚öôÔ∏è Settings</button>
            <div id="status" class="text-[10px] text-green-500">System Ready</div>
        </div>
    </div>

    <div id="modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-4">
        <div class="bg-slate-800 p-6 rounded-2xl w-full max-w-sm">
            <h2 class="font-bold mb-4">AI Configuration</h2>
            <input id="api-key" type="password" placeholder="Paste OpenRouter API Key" class="w-full p-2 mb-3 rounded bg-slate-700 border-none">
            <input id="model" type="text" value="google/gemini-2.0-flash-001" class="w-full p-2 mb-4 rounded bg-slate-700 border-none">
            <button onclick="save()" class="w-full bg-blue-600 py-2 rounded-lg font-bold">Save Config</button>
        </div>
    </div>

    <script>
        let key = localStorage.getItem('key') || '';
        let model = localStorage.getItem('model') || 'google/gemini-2.0-flash-001';

        function toggleSettings() { document.getElementById('modal').classList.toggle('hidden'); }
        function save() {
            key = document.getElementById('api-key').value;
            model = document.getElementById('model').value;
            localStorage.setItem('key', key);
            localStorage.setItem('model', model);
            toggleSettings();
        }

        async function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'hi-IN';
            window.speechSynthesis.speak(utterance);
        }

        async function send() {
            const input = document.getElementById('input');
            const chat = document.getElementById('chat-box');
            if(!input.value || !key) return;

            const text = input.value;
            chat.innerHTML += `<div class="user-bubble">${text}</div>`;
            input.value = '';
            chat.scrollTop = chat.scrollHeight;

            try {
                document.getElementById('status').innerText = "AI is thinking...";
                const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${key}`, "Content-Type": "application/json" },
                    body: JSON.stringify({ "model": model, "messages": [{"role": "system", "content": "You are a helpful assistant. Keep in mind the user has an MGVCL Smart Meter installed recently in Feb 2026 after the Jan bill."}, {"role": "user", "content": text}] })
                });
                const data = await res.json();
                const reply = data.choices[0].message.content;
                chat.innerHTML += `<div class="ai-bubble">${reply}</div>`;
                speak(reply);
                document.getElementById('status').innerText = "System Ready";
            } catch (e) {
                chat.innerHTML += `<div class="ai-bubble text-red-400">Error: Check API/Connection</div>`;
            }
            chat.scrollTop = chat.scrollHeight;
        }
    </script>
</body>
</html>
